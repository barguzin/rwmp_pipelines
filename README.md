# Regional Wildfire Mitigation Program - Analytical Data Pipelines on Evacuation Simulation

[RWMP](https://rwmpsantabarbara.org/) repo for geospatial analysis workflows using SUMO software for modeling evacuation modeling. 

## Data 

Most of the data comes from OpenStreetMap (OSM) and is either downloaded programmatically via SUMO tools and/or osmnx, or pre-downloaded manually from GeoFabrik and clipped to the study area. 

### Road network 

1. US Census TIGER Centerlines 
2. OSM roads 
3. Service Roads 

### Buildings 

1. Microsoft building footprints available on [Github](https://github.com/microsoft/USBuildingFootprints)
2. OSM buildings (pre-loaded from GeoFabrik and clipped by the study area)

### Data Listing in the repo

|nn|name|description|
|---|---|---|
|1|study_area.osm.xml|downloaded OSM xml for the study area. Generated by running src/od_utils.py|
|2|study_area.net.xml|SUMO network file generated by converting OSM XML via SUMO tools. See [sumo_script.md](evac/src/sumo_script.md) - item 6 for more details. 
|3|districts.taz.xml|SUMO-formatted xml where each transportation analysis zone has an associated list of origin-destination edgges. Used to generated routes| 
|4|od_test.od|origin destination file with traffic volumes from each O-D pair and associated times of departure|
|5|||

---

## Analytical Workflow

The outline of the workflow (including *Data preparation* workflow) is available in the file [sumo_script.md](evac/src/sumo_script.md).

## Python Code and Functions 

|nn|name|description|
|---|---|---|
|1|src/get_osm_by_poly.py|function that automatically downloads the data from OSM and creates SUMO network from the downloaded file. In contrast to SUMO web OSM Wizard, one can use a polygon as a bounding box. Also, this code does not generate random traffic patterns, which make no sense for evacuation modeling| 
|2|src/od_utils.py|all utility functions to generate origin destination traffic flows| 

## Python Notebooks 

The notebooks should be used for illustration purposes only. They have been utilized to prototype development and basic data analysis. 

|nn|name|description|
|---|---|---|
|1|network_analysis_demo.ipynb|some useful functions from osmnx| 
|2|sumolib.ipynb|notebook for prototyping functions located in src/ directory| 
|3|network_analysis_demo.ipynb|demo on how to use osmnx and networkx to visualize road network for the study area programmatically| 
|4|network_file.ipynb|some useful functions from osmnx| 
|5|get_osm_data.ipynb|exploring interoperability between OSM formats used for this project (e.g. SUMO and osmnx)| 
